<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">

  <head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
  <link href="http://gmpg.org/xfn/11" rel="profile">
  <link rel="stylesheet" href="http://fonts.googleapis.com/css?family=Open+Sans:300,400italic,400,600,700|Abril+Fatface">
  <link href='http://fonts.googleapis.com/css?family=Inconsolata:400,700' rel='stylesheet' type='text/css'>
  <title>
    Hoofdstuk 4 &middot; 
    Rubyprog
  </title>

  <!-- CSS -->
  <link href="/public/bootstrap/css/bootstrap.css" rel="stylesheet">
  <!-- <link href="/public/bootstrap/css/bootstrap-theme.min.css" rel="stylesheet"> -->
  
  <link href="/public/css/syntax.css" rel="stylesheet">
</head>


  <body class="scrollspy">

  <header>

  <!-- <img src="/public/images/logo.png" height="65px" style="padding:0px; margin-top:13px;"> -->
  <!-- <img src="/public/images/logo.png" height="60px" style="padding:0px; margin:0px;"/> -->
  <div class="navbar navbar-inverse" role="navigation">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/"><img id="rubylogo" src="/public/images/logo.png"></a>
      </div>
      <div class="navbar-collapse collapse">
        <ul class="nav navbar-nav navbar-right">
          <li><a href="/introductie">Introductie</a></li>
          <!-- <li><a href="">Contact</a></li> -->
          <li class="dropdown">
            <a href="#" class="dropdown-toggle" data-toggle="dropdown">Cursus <b class="caret"></b></a>
            <ul class="dropdown-menu">
              <li><a href="/installatie">Installatie</a></li>
              <li><a href="/command_line">Command Line</a></li>
              <li class="divider"></li>
              <li><a href="/hoofdstuk1">Hoofdstuk 1</a></li>
              <li><a href="/hoofdstuk2">Hoofdstuk 2</a></li>
              <li><a href="/hoofdstuk3">Hoofdstuk 3</a></li>
              <li><a href="/hoofdstuk4">Hoofdstuk 4</a></li>
            </ul>
          </li>
        </ul>
      </div><!--/.nav-collapse -->
    </div>
  </div>
</header> 

    <div class="container content">

      <h1 id="hoofdstuk_4_tic_tac_toe">Hoofdstuk 4: Tic Tac Toe</h1>

<p>Wie kent het niet: boter, kaas en eieren? Het werd al rond 100 jaar voor Christus gespeeld door de Romeinen en nu nog steeds. We gaan in deze les het spel aan de computer uitleggen, zodat je het digitaal kunt spelen. In de extra opdracht kun je zelfs de computer tegen jou laten spelen.</p>

<h2 id="bestanden">Bestanden</h2>

<p>In deze map vind je de volgende bestanden:</p>

<pre><code>Hoofdstuk4.url - deze beschrijving
readme.html
tictactoe.rb
game.rb
narrator.rb</code></pre>

<h2 id="informatie">Informatie</h2>

<h3 id="objecten">Objecten</h3>

<p>Om de wereld zo begrijpelijk mogelijk te vatten in code, gebruiken veel programmeertalen objecten (<code>Objects</code>). Ook Ruby. In onderstaand voorbeeld willen we boeken modelleren:</p>
<div class='highlight'><pre><code class='ruby'><span class='k'>class</span> <span class='nc'>Book</span>
    <span class='k'>def</span> <span class='nf'>initialize</span><span class='p'>(</span><span class='n'>author</span><span class='p'>,</span> <span class='n'>title</span><span class='p'>,</span> <span class='n'>content</span><span class='p'>)</span>
        <span class='vi'>@author</span> <span class='o'>=</span> <span class='n'>author</span>
        <span class='vi'>@title</span> <span class='o'>=</span> <span class='n'>title</span>
        <span class='vi'>@content</span> <span class='o'>=</span> <span class='n'>content</span>
    <span class='k'>end</span>
<span class='k'>end</span>
</code></pre></div>
<p>Een klasse (<code>Class</code>) is de blauwdruk van een object.</p>

<p><code>initialize</code> is een speciale functie, die wordt uitgevoerd zodra er een object van klasse <code>Book</code> wordt aangemaakt. Je maakt een object door <code>new</code> aan te roepen:</p>
<div class='highlight'><pre><code class='ruby'><span class='n'>book1</span> <span class='o'>=</span> <span class='no'>Book</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='s2'>&quot;Lord of the Rings&quot;</span><span class='p'>,</span> <span class='s2'>&quot;J. R. R. Tolkien&quot;</span><span class='p'>,</span> <span class='s2'>&quot;Three Rings for the Elven-kings ...&quot;</span><span class='p'>)</span>
<span class='n'>book2</span> <span class='o'>=</span> <span class='no'>Book</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='s2'>&quot;Titaantjes&quot;</span><span class='p'>,</span> <span class='s2'>&quot;Nescio&quot;</span><span class='p'>,</span> <span class='s2'>&quot;Jongens waren we - maar aardige jongens. Al zeg ik &#39;t zelf ...&quot;</span><span class='p'>)</span>
</code></pre></div>
<p>Elk boek heeft dezelfde structuur, die wordt bepaald door de klasse <code>Book</code>. Het is een container van de variabelen <code>author</code>, <code>title</code> en <code>content</code>. Variabelen die bij een object horen — <em>instance variables</em> — beginnen met een <code>@</code>.</p>

<p>Deze variabelen zijn afgeschermd van de code buiten de klasse:</p>
<div class='highlight'><pre><code class='ruby'><span class='n'>book1</span><span class='o'>.</span><span class='n'>title</span> <span class='c1'># =&gt; NoMethodError: undefined method `title&#39;</span>
</code></pre></div>
<p>Als je bepaalde variabelen beschikbaar wilt maken, doe je dat met <code>attr_accessor</code>:</p>
<div class='highlight'><pre><code class='ruby'><span class='k'>class</span> <span class='nc'>Book</span>
    <span class='kp'>attr_accessor</span> <span class='ss'>:title</span><span class='p'>,</span> <span class='ss'>:author</span><span class='p'>,</span> <span class='ss'>:content</span>

    <span class='k'>def</span> <span class='nf'>initialize</span><span class='p'>(</span><span class='n'>author</span><span class='p'>,</span> <span class='n'>title</span><span class='p'>,</span> <span class='n'>content</span><span class='p'>)</span>
        <span class='vi'>@author</span> <span class='o'>=</span> <span class='n'>author</span>
        <span class='vi'>@title</span> <span class='o'>=</span> <span class='n'>title</span>
        <span class='vi'>@content</span> <span class='o'>=</span> <span class='n'>content</span>
    <span class='k'>end</span>
<span class='k'>end</span>
</code></pre></div>
<p>Nu kunnen we aan het boek vragen wat zijn titel is:</p>
<div class='highlight'><pre><code class='ruby'><span class='n'>book1</span><span class='o'>.</span><span class='n'>title</span> <span class='c1'># =&gt; &quot;Lord of the Rings&quot;</span>
<span class='n'>book1</span><span class='o'>.</span><span class='n'>author</span> <span class='c1'># =&gt; &quot;J. R. R. Tolkien&quot;</span>
</code></pre></div>
<p>En we kunnen attributen veranderen:</p>
<div class='highlight'><pre><code class='ruby'><span class='n'>book2</span><span class='o'>.</span><span class='n'>title</span> <span class='o'>=</span> <span class='s2'>&quot;De uitvreter&quot;</span>
<span class='n'>book2</span><span class='o'>.</span><span class='n'>content</span> <span class='o'>=</span> <span class='s2'>&quot;Behalve den man, die de Sarphatistraat ...&quot;</span>

<span class='n'>book2</span><span class='o'>.</span><span class='n'>title</span> <span class='c1'># =&gt; &quot;De uitvreter&quot;</span>
</code></pre></div>
<p>So far so good.</p>

<p>Stel dat we willen bijhouden waar we zijn gebleven met lezen. Bij elk nieuw boek dat we maken, zetten we de variable <code>@current_page</code> op 1. Dit gebeurt dus in <code>initialize</code>. We schrijven een functie <code>flip_page</code>:</p>
<div class='highlight'><pre><code class='ruby'><span class='k'>class</span> <span class='nc'>Book</span>
    <span class='kp'>attr_accessor</span> <span class='ss'>:title</span><span class='p'>,</span> <span class='ss'>:author</span><span class='p'>,</span> <span class='ss'>:content</span><span class='p'>,</span> <span class='ss'>:current_page</span>

    <span class='k'>def</span> <span class='nf'>initialize</span><span class='p'>(</span><span class='n'>author</span><span class='p'>,</span> <span class='n'>title</span><span class='p'>,</span> <span class='n'>content</span><span class='p'>)</span>
        <span class='vi'>@author</span> <span class='o'>=</span> <span class='n'>author</span>
        <span class='vi'>@title</span> <span class='o'>=</span> <span class='n'>title</span>
        <span class='vi'>@content</span> <span class='o'>=</span> <span class='n'>content</span>
        <span class='vi'>@current_page</span> <span class='o'>=</span> <span class='mi'>1</span>
    <span class='k'>end</span>

    <span class='k'>def</span> <span class='nf'>flip_page</span>
        <span class='vi'>@current_page</span> <span class='o'>=</span> <span class='vi'>@current_page</span> <span class='o'>+</span> <span class='mi'>1</span>
    <span class='k'>end</span>
<span class='k'>end</span>
</code></pre></div>
<p>Niet vergeten <code>:current_page</code> toe te voegen aan <code>attr_accessor</code>. Nu kunnen we dit doen:</p>
<div class='highlight'><pre><code class='ruby'><span class='n'>book1</span><span class='o'>.</span><span class='n'>current_page</span> <span class='c1'># =&gt; 1</span>
<span class='n'>book1</span><span class='o'>.</span><span class='n'>flip_page</span> 
<span class='n'>book1</span><span class='o'>.</span><span class='n'>current_page</span> <span class='c1'># =&gt; 2</span>
</code></pre></div>
<p>Als we de woorden van een boek nodig hebben, dan definiëren we gewoon een functie <code>words</code>:</p>
<div class='highlight'><pre><code class='ruby'><span class='k'>class</span> <span class='nc'>Book</span>
    <span class='kp'>attr_accessor</span> <span class='ss'>:title</span><span class='p'>,</span> <span class='ss'>:author</span><span class='p'>,</span> <span class='ss'>:content</span><span class='p'>,</span> <span class='ss'>:current_page</span>

    <span class='k'>def</span> <span class='nf'>initialize</span><span class='p'>(</span><span class='n'>author</span><span class='p'>,</span> <span class='n'>title</span><span class='p'>,</span> <span class='n'>content</span><span class='p'>)</span>
        <span class='vi'>@author</span> <span class='o'>=</span> <span class='n'>author</span>
        <span class='vi'>@title</span> <span class='o'>=</span> <span class='n'>title</span>
        <span class='vi'>@content</span> <span class='o'>=</span> <span class='n'>content</span>
        <span class='vi'>@current_page</span> <span class='o'>=</span> <span class='mi'>1</span>
    <span class='k'>end</span>

    <span class='k'>def</span> <span class='nf'>flip_page</span>
        <span class='vi'>@current_page</span> <span class='o'>=</span> <span class='vi'>@current_page</span> <span class='o'>+</span> <span class='mi'>1</span>
    <span class='k'>end</span>

    <span class='k'>def</span> <span class='nf'>words</span>
        <span class='vi'>@content</span><span class='o'>.</span><span class='n'>split</span><span class='p'>(</span><span class='s2'>&quot; &quot;</span><span class='p'>)</span>
    <span class='k'>end</span>
<span class='k'>end</span>
</code></pre></div><div class='highlight'><pre><code class='ruby'><span class='n'>book1</span><span class='o'>.</span><span class='n'>words</span> <span class='c1'># =&gt; [&quot;Three&quot;, &quot;rings&quot;, &quot;for&quot;, ... ]</span>
</code></pre></div>
<p>Wat is het voordeel van objecten? Zodra we de blauwdruk hebben gespecificeerd, kunnen we precies vragen aan het object wat we nodig hebben. Niets meer en niets minder. Dit geeft overzicht, en maakt software hergebruiken makkelijk.</p>

<p>Nu weten jullie wat hier gebeurt:</p>
<div class='highlight'><pre><code class='ruby'><span class='n'>getallen</span> <span class='o'>=</span> <span class='o'>[</span><span class='mi'>1</span><span class='p'>,</span> <span class='mi'>2</span><span class='p'>,</span> <span class='mi'>3</span><span class='p'>,</span> <span class='mi'>4</span><span class='p'>,</span> <span class='mi'>5</span><span class='o'>]</span>
<span class='n'>getallen</span><span class='o'>.</span><span class='n'>max</span> <span class='c1'># =&gt; 5</span>
</code></pre></div>
<p><code>getallen</code> is een object, van de klasse <code>Array</code>! <code>max</code> is een functie die in deze klasse staat gedefinieerd. Stiekem is alles in Ruby een object:</p>
<div class='highlight'><pre><code class='ruby'><span class='s2'>&quot;Obama&quot;</span><span class='o'>.</span><span class='n'>reverse</span> <span class='c1'># =&gt; &quot;amabO&quot;</span>
</code></pre></div>
<p><code>&quot;Obama&quot;</code> is een object van klasse <code>String</code>, met een functie <code>reverse</code>.</p>

<p>Laat je niet overdonderen. Het kost de meeste mensen minstens een half jaar om aan <em>objectgeörienteerd</em> programmeren gewend te raken.</p>

<h3 id="_en_"><code>require</code> en <code>require_relative</code></h3>

<p>Je hoeft het wiel niet opnieuw uit te vinden. Voorbeeld: je wilt een datum omrekenen naar een weekdag. Daar heeft Ruby al iets op bedacht. Je “leent” het bestand <code>date</code> uit de <em>standard library</em>. Daar staan alle files die standaard bij de Ruby-taal geleverd worden. Dat gaat zo:</p>
<div class='highlight'><pre><code class='ruby'><span class='nb'>require</span> <span class='s2'>&quot;date&quot;</span>

<span class='n'>date</span> <span class='o'>=</span> <span class='no'>Date</span><span class='o'>.</span><span class='n'>new</span><span class='p'>(</span><span class='mi'>2014</span><span class='p'>,</span> <span class='mi'>2</span><span class='p'>,</span> <span class='mi'>3</span><span class='p'>)</span>
<span class='n'>date</span><span class='o'>.</span><span class='n'>wday</span> <span class='c1'># =&gt; 2</span>
<span class='n'>date</span><span class='o'>.</span><span class='n'>tuesday?</span> <span class='c1'># =&gt; true</span>
</code></pre></div>
<p>Nu kun je alle code uit <code>date</code> aanroepen, zonder te weten wat er precies in dat bestand staat. Op de <a href="http://ruby-doc.org/stdlib-1.9.3/libdoc/date/rdoc/Date.html#method-i-wday">pagina van <code>date</code></a> staat wat je er mee kunt doen. In Ruby hoef je bijna geen basisfunctionaliteit zelf te schrijven. Kijk dus eerst in de <a href="http://ruby-doc.org/core-1.9.3/">documentatie</a>, zodat je geen onnodig werk doet.</p>

<p>Grote programma’s worden vaak gesplitst in meerdere bestanden. Dit geeft overzicht. Als je code uit je eigen mappen wilt aanroepen, moet je <code>require_relative</code> gebruiken.</p>

<p>In de map <code>Hoofdstuk4</code> staat <code>tictactoe.rb</code>. Dit bestand willen we uitvoeren om het spel te starten. Maar om het overzicht te bewaren, zetten we alle code van de klasse <code>Game</code> in <code>game.rb</code> en van klasse <code>Narrator</code> in <code>narrator.rb</code>. In <code>tictactoe.rb</code> zetten we vervolgens:</p>
<div class='highlight'><pre><code class='ruby'><span class='n'>require_relative</span> <span class='s2'>&quot;game&quot;</span>
<span class='n'>require_relative</span> <span class='s2'>&quot;narrator&quot;</span>

<span class='n'>game</span> <span class='o'>=</span> <span class='no'>Game</span><span class='o'>.</span><span class='n'>new</span>
<span class='n'>narrator</span> <span class='o'>=</span> <span class='no'>Narrator</span><span class='o'>.</span><span class='n'>new</span>
</code></pre></div>
<p>Zoals je ziet, kun je <code>.rb</code> weglaten uit de bestandsnaam.</p>

<h3 id="2darray">2D-array</h3>

<p>Je hebt al kennis gemaakt met arrays. Nu gaan we een stapje verder: tweedimensionale arrays. Dit zijn arrays in arrays. Het spelbord is precies dat:</p>
<div class='highlight'><pre><code class='ruby'><span class='o'>[[</span><span class='s2'>&quot;X&quot;</span><span class='p'>,</span> <span class='s2'>&quot;X&quot;</span><span class='p'>,</span> <span class='s2'>&quot;O&quot;</span><span class='o'>]</span><span class='p'>,</span> <span class='o'>[</span><span class='s2'>&quot;O&quot;</span><span class='p'>,</span> <span class='s2'>&quot;O&quot;</span><span class='p'>,</span> <span class='s2'>&quot;X&quot;</span><span class='o'>]</span><span class='p'>,</span> <span class='o'>[</span><span class='s2'>&quot; &quot;</span><span class='p'>,</span> <span class='s2'>&quot; &quot;</span><span class='p'>,</span> <span class='s2'>&quot;O&quot;</span><span class='o'>]]</span>
</code></pre></div>
<p>Je ziet dat er één grote array is met daarin drie kleine arrays. Deze kleine arrays vormen de rijen van het bord:</p>

<pre><code> X | X | O 
---|---|---
 O | O | X 
---|---|---
   |   | O </code></pre>

<p>Probeer zelf een paar van dit soort arrays te maken in <code>irb</code>, zodat je echt begrijpt hoe ze werken.</p>

<h2 id="de_opdracht">De opdracht</h2>

<h3 id="de_spelregels">De spelregels</h3>

<p>Jullie zullen vooral aan de <code>Game</code>-klasse werken. Deze klasse bevat alle spellogica. We moeten aan een <code>Game</code>-object kunnen vragen wie er aan de beurt is, of het spel al over is, hoe het huidige bord eruit ziet, enzovoort. Bovendien moeten we een zet kunnen doen.</p>
<div class='highlight'><pre><code class='ruby'><span class='n'>game</span> <span class='o'>=</span> <span class='no'>Game</span><span class='o'>.</span><span class='n'>new</span>
<span class='n'>game</span><span class='o'>.</span><span class='n'>over?</span> <span class='c1'># =&gt; false</span>
<span class='n'>game</span><span class='o'>.</span><span class='n'>current_player</span> <span class='c1'># =&gt; &quot;Player 1&quot;</span>
<span class='n'>game</span><span class='o'>.</span><span class='n'>play</span><span class='p'>(</span><span class='mi'>1</span><span class='p'>)</span>
<span class='n'>game</span><span class='o'>.</span><span class='n'>current_player</span> <span class='c1'># =&gt; &quot;Player 2&quot;</span>
</code></pre></div>
<p>Het leek ons handig om de plaatsen op het bord te nummeren zoals het NumPad. 7 is linksboven, 1 is linksonder, enz. <code>game.play(1)</code> betekent: de speler die aan de beurt is speelt linksonder. Welke speler aan de beurt is, moet het <code>Game</code>-object zelf bijhouden.</p>

<h3 id="het_bord_tekenen">Het bord tekenen</h3>

<p>Kijk eens naar de <code>Narrator</code>-klasse, in <code>narrator.rb</code>. Dit kun je ermee:</p>
<div class='highlight'><pre><code class='ruby'><span class='n'>narrator</span> <span class='o'>=</span> <span class='no'>Narrator</span><span class='o'>.</span><span class='n'>new</span>

<span class='n'>board</span> <span class='o'>=</span> <span class='o'>[[</span><span class='s2'>&quot; &quot;</span><span class='p'>,</span> <span class='s2'>&quot;X&quot;</span><span class='p'>,</span> <span class='s2'>&quot; &quot;</span><span class='o'>]</span><span class='p'>,</span> 
        <span class='o'>[</span><span class='s2'>&quot;O&quot;</span><span class='p'>,</span> <span class='s2'>&quot;X&quot;</span><span class='p'>,</span> <span class='s2'>&quot; &quot;</span><span class='o'>]</span><span class='p'>,</span> 
        <span class='o'>[</span><span class='s2'>&quot; &quot;</span><span class='p'>,</span> <span class='s2'>&quot; &quot;</span><span class='p'>,</span> <span class='s2'>&quot;O&quot;</span><span class='o'>]]</span>
<span class='n'>narrator</span><span class='o'>.</span><span class='n'>draw_board</span><span class='p'>(</span><span class='n'>board</span><span class='p'>)</span>
</code></pre></div>
<p>Kijk maar wat je dan krijgt!</p>

<p>De lege functie <code>intro</code> mogen jullie gebruiken, maar het hoeft niet. Het is maar een ideetje. Je kunt er handig gebruik van maken in het hoofdbestand <code>tictactoe.rb</code>:</p>
<div class='highlight'><pre><code class='ruby'><span class='n'>narrator</span> <span class='o'>=</span> <span class='no'>Narrator</span><span class='o'>.</span><span class='n'>new</span>
<span class='n'>narrator</span><span class='o'>.</span><span class='n'>intro</span> 
</code></pre></div>
<p>In <code>narrator.rb</code> kun je <code>intro</code> programmeren zoals je wilt. Misschien wil je de spelers begroeten, of de regels uitleggen. Het gaat erom dat het hoofdbestand <code>tictactoe.rb</code> overzichtelijk blijft: het scheelt enorm als je alleen een instructie hoeft te geven aan het <code>Narrator</code>-object. <code>narrator.intro</code> is een stuk duidelijker dan meerdere regels met <code>puts</code>- commando’s.</p>

<h3 id="pen_en_papier">Pen en papier</h3>

<p>Het is verleidelijk om meteen te gaan typen. Maar begin eens met pen en papier. Hoe verloopt een speelbeurt? Wanneer is het spel afgelopen? Schroom niet om functies toe te voegen aan <code>Game</code> of <code>Narrator</code>.</p>

<h3 id="extra_tegen_de_computer">(Extra) Tegen de computer</h3>

<p>De ultieme uitdaging van deze cursus. Maak een klasse <code>ComputerPlayer</code> en zorg dat je tegen de computer kunt spelen!</p>
<p><iframe allowfullscreen='allowfullscreen' frameborder='0' height='315' src='//www.youtube.com/embed/F7qOV8xonfY' width='420'>  </iframe></p>

    </div>

  <footer>
  <div class="container">
    <p><a href="/" id="logo" class="footer-brand">ruby{prog}</a></p>

    <p>Deze cursus is ontwikkeld door Geert Kapteijns en Boris Ponsioen. Het materiaal is vrij te gebruiken onder de <a href="http://creativecommons.org/licenses/by-nc/4.0/deed.nl">CC BY-NC 4.0-licentie</a> --- je mag er alles mee doen, zolang het maar niet-commercieel is.</p>

    <p>Meehelpen? Zie de <a href="https://github.com/b1592/b1592.github.io">Github-pagina.</a></p>

    <p>Alle kritiek is welkom. Mail naar <a href="mailto:ghkapteijns@gmail.com">ghkapteijns@gmail.com</a>.
  </div>
</footer>

  <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-47467348-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>

  <!-- Load JS here for greater good =============================-->
    <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
    <script src="/public/bootstrap/js/bootstrap.min.js"></script>
    <script src="/public/js/custom.js"></script>
  </body>
</html>
